---
title: "Dynamic Tool Discovery"
description: "Discover and call tools programmatically"
---

When you don't know which tool to use, call `capabilities_discover` with a task description, then `capability_details` for schemas, then `tools/call` on the recommended server path. Both discovery tools live on `/pinkfish-sidekick`.

## Example: Discovery and Execution

```javascript
const MCP_URL = "https://mcp.app.pinkfish.ai";
const TOKEN = "<YOUR_PLATFORM_JWT>";

const headers = {
  Authorization: `Bearer ${TOKEN}`,
  "Content-Type": "application/json",
  Accept: "application/json",
};

async function callTool(serverPath, toolName, args) {
  const resp = await fetch(`${MCP_URL}${serverPath}`, {
    method: "POST",
    headers,
    body: JSON.stringify({
      jsonrpc: "2.0",
      method: "tools/call",
      params: { name: toolName, arguments: args },
      id: 1,
    }),
  });
  const result = await resp.json();
  if (result.error) throw new Error(result.error.message);
  return result.result;
}

// Prefer structuredContent (new standard); fall back to legacy content[0].text
function parseResult(r) {
  if (r?.structuredContent) return r.structuredContent;
  return JSON.parse(r?.content?.[0]?.text ?? "{}");
}

async function discover(task) {
  const r = await callTool("/pinkfish-sidekick", "capabilities_discover", { request: task });
  return parseResult(r);
}

async function getDetails(items) {
  const r = await callTool("/pinkfish-sidekick", "capability_details", { items });
  return parseResult(r);
}

// 1. Discover tools for a task
const capabilities = await discover("search the web for AI news");
const topTool = capabilities.tools?.[0];
if (!topTool) throw new Error("No tools found");

// 2. Get full schema (optional — use when you need parameter details)
const details = await getDetails([topTool.name]);

// 3. Call the tool
const result = await callTool(`/${topTool.serverName}`, topTool.name, {
  query: "latest AI news 2026",
});
console.log(parseResult(result));
```

<Note>
Runs in Node.js 18+ (native fetch) or browser. For Python, use `requests.post()` with the same JSON-RPC payload structure.
</Note>

## Key Points

- **Embedded tools** (web-search, filestorage, AI models) — No PCID required
- **Application tools** (Gmail, Slack, etc.) — Include `PCID` from discovery or [Connections](/api-reference/platform/connections)
- **`capability_details`** — Pass `tool.name`, not `serverName`

## Custom Agents

For custom AI agents (Claude, OpenAI, etc.) that call the MCP Farm over HTTP: bootstrap with `capabilities_discover` and `capability_details`, fetch schemas for the user's task, map to your model's function-calling format, and route tool calls to `tools/call` on the server path. `capability_details` returns `inputSchema`, `serverName`, and `description` per tool.
