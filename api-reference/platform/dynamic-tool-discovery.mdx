---
title: "Dynamic Tool Discovery"
description: "Discover tools at runtime and call them programmatically"
---

## Overview

When you don't know which tool to use, use the discovery flow on `/pinkfish-sidekick`:

1. **`capabilities_discover`** — Describe your task in natural language; returns recommended tools, connections, and resources
2. **`capability_details`** — Pass tool names; returns full `inputSchema` and `serverName` for routing

Then call the recommended tool via `tools/call` on the server path.

## Example: Discovery and Execution

```javascript
const MCP_URL = "https://mcp.app.pinkfish.ai";
const TOKEN = "<YOUR_PLATFORM_JWT>";

const headers = {
  Authorization: `Bearer ${TOKEN}`,
  "Content-Type": "application/json",
  Accept: "application/json",
};

async function callTool(serverPath, toolName, args) {
  const resp = await fetch(`${MCP_URL}${serverPath}`, {
    method: "POST",
    headers,
    body: JSON.stringify({
      jsonrpc: "2.0",
      method: "tools/call",
      params: { name: toolName, arguments: args },
      id: 1,
    }),
  });
  const result = await resp.json();
  if (result.error) throw new Error(result.error.message);
  return result.result;
}

async function discover(task) {
  const r = await callTool("/pinkfish-sidekick", "capabilities_discover", { request: task });
  return JSON.parse(r?.content?.[0]?.text ?? "{}");
}

async function getDetails(items) {
  const r = await callTool("/pinkfish-sidekick", "capability_details", { items });
  return JSON.parse(r?.content?.[0]?.text ?? "{}");
}

// 1. Discover tools for a task
const capabilities = await discover("search the web for AI news");
const topTool = capabilities.tools?.[0];
if (!topTool) throw new Error("No tools found");

// 2. Get full schema (optional — use when you need parameter details)
const details = await getDetails([topTool.name]);

// 3. Call the tool
const result = await callTool(`/${topTool.serverName}`, topTool.name, {
  query: "latest AI news 2026",
});
console.log(result?.content?.[0]?.text);
```

<Note>
Runs in Node.js 18+ (native fetch) or browser. For Python, use `requests.post()` with the same JSON-RPC payload structure.
</Note>

## Key Points

- **Embedded tools** (web-search, filestorage, AI models) — No PCID required
- **Application tools** (Gmail, Slack, Salesforce) — Include `PCID` from discovery or [Connections](/api-reference/platform/connections)
- **Tool names** — Pass `tool.name` to `capability_details`, not `serverName`

## Advanced: Dynamic Tool Installation for Custom Agents

If you're building a custom AI agent (Claude, OpenAI, etc.) that calls the MCP Farm over HTTP, you can **dynamically install discovered tools** into the agent's tool set so the model calls them natively. This is a pattern for integrators building their own agents — not a platform-provided feature.

**Pattern:**

1. Bootstrap your agent with only `capabilities_discover` and `capability_details`
2. Agent discovers tools for the user's task
3. Your code fetches schemas via `capability_details`, converts to your model's format (Claude `input_schema`, OpenAI `parameters`), and adds them to the agent's tool set
4. Re-run the agent loop — the model now sees the new tools
5. When the model calls one, route it to the MCP Farm via `tools/call` on the server path

**`capability_details` returns** `inputSchema` (standard JSON Schema), `serverName`, and `description` per tool. Map these directly to your model's function-calling format.

<Note>
Install only what you need. `capability_details` returns schemas for the specific tools discovered — typically 1–5 tools instead of fetching an entire server's list.
</Note>
