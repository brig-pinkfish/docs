---
title: "MCP Protocol"
description: "JSON-RPC 2.0 format, listing servers, and calling tools"
---

## Overview

The MCP Farm implements the **Model Context Protocol (MCP)** over HTTP. It uses the official `@modelcontextprotocol/sdk`, JSON-RPC 2.0 message format, and standard MCP methods (`tools/list`, `tools/call`). Every call is an HTTP POST to a server path with a JSON-RPC payload in the body.

**Base URL:** `https://mcp.app.pinkfish.ai`

All requests require a runtime token. See [Authentication](/api-reference/platform/authentication) for how to obtain one.

## Getting Started

1. **Get a token** — Exchange your API key for a runtime token via `/auth/token`
2. **List servers** — Call `listServers` on `/mcp` to see available servers and their tools
3. **Call a tool** — POST `tools/call` to the server path with the tool name and arguments

## When to Use What

| You know... | Use |
|-------------|-----|
| The tool and server | Call `tools/call` directly on the server path (e.g. `/web-search`, `/gmail`) |
| The task, not the tool | Use [Discovery](/api-reference/platform/discovery): `capabilities_discover` → `capability_details` → then call the recommended tool |

## Request Format

All requests use this structure:

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/<server-path>" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "<method>",
    "params": {
      "name": "<tool_name>",
      "arguments": { ... }
    },
    "id": 1
  }'
```

**Required headers:**

| Header | Value |
|--------|-------|
| `Authorization` | `Bearer <runtime_token>` |
| `Content-Type` | `application/json` |
| `Accept` | `application/json` |

**JSON-RPC fields:**

| Field | Description |
|-------|-------------|
| `jsonrpc` | Always `"2.0"` |
| `method` | The JSON-RPC method — typically `"tools/call"` or `"tools/list"` |
| `params` | Method parameters — for `tools/call`, includes `name` (tool name) and `arguments` (tool inputs) |
| `id` | Request identifier (any integer) |

## List Servers

Query available servers and their tools:

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/mcp" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "listServers",
      "arguments": {}
    },
    "id": 1
  }'
```

**Response (abbreviated):**

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [{
      "type": "text",
      "text": "{\"servers\": [{\"name\": \"gmail\", \"path\": \"/gmail\", \"description\": \"Gmail API\", \"embedded\": false, \"tools\": [...]}, ...]}"
    }]
  }
}
```

Each server entry includes:

| Field | Description |
|-------|-------------|
| `name` | Server identifier (e.g., `gmail`, `slack`, `datastore-structured`) |
| `path` | URL path to call this server (e.g., `/gmail`) |
| `description` | What the server does |
| `embedded` | `true` = built-in platform service, `false` = external application requiring a connection |
| `tools` | Array of tools provided by this server |

## List Tools

Call `tools/list` on a server path to see its tools:

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/gmail" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/list",
    "id": 1
  }'
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "tools": [
      {
        "name": "gmail_search_emails",
        "description": "Search emails in Gmail",
        "inputSchema": {
          "type": "object",
          "properties": {
            "PCID": { "type": "string", "description": "PinkConnect connection ID" },
            "query": { "type": "string", "description": "Gmail search query" }
          },
          "required": ["PCID", "query"]
        }
      }
    ]
  }
}
```

Each tool includes an `inputSchema` (JSON Schema) for its parameters.

## Call a Tool

POST `tools/call` to the server path with the tool name and arguments:

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/<server-path>" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "<tool_name>",
      "arguments": {
        "key": "value"
      }
    },
    "id": 1
  }'
```

### Example: Search the Web

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/web-search" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "search_googlesearch",
      "arguments": {
        "query": "latest AI news"
      }
    },
    "id": 1
  }'
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [{
      "type": "text",
      "text": "{ ... search results ... }"
    }]
  }
}
```

### Example: External Service (Gmail)

Application tools (Gmail, Slack, etc.) require a `PCID`. See [Connections](/api-reference/platform/connections).

```bash
curl -s -X POST "https://mcp.app.pinkfish.ai/gmail" \
  -H "Authorization: Bearer $PINKFISH_TOKEN" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "gmail_search_emails",
      "arguments": {
        "PCID": "abc123-def456",
        "query": "is:unread"
      }
    },
    "id": 1
  }'
```

## Response Format

**Success:** `result.content[0].text` contains the tool output as a JSON string. Parse it for structured data.

**Error:** Responses include `error.code` and `error.message`:

| Code | Meaning |
|------|---------|
| `-32000` | Server error — validation failure, timeout, unsupported media type, or other server-side issue |
| `-32603` | Internal error — unexpected failure during request processing |

The `message` field contains a human-readable description. Common causes for `-32000`: missing or invalid `Accept: application/json` header, missing `Content-Type: application/json`, request body too large, or request timed out.
